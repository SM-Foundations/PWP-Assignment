Assignment_Main.py - Pseudocode (updated to match current function implementations)

Purpose:
- High-level pseudocode for the library management program: Admin, Staff, Member credentials and a book repository.

Imports:
- Uses: os, time, datetime (used for file checks, sleeping and lockout timing)

--- Global constants / file names ---
SET admin_file_C = "Admin Cred.txt"
SET staff_file_C = "Staff Cred.txt"
SET member_file_C = "Member Cred.txt"
SET admin_file_P = "Admin Password.txt"
SET staff_file_P = "Staff Password.txt"
SET member_file_P = "Member Password.txt"
SET repository = "Book_Collection.txt"
SET BookLog = "Book_Logs.txt"

--- MAIN MENU ---
Start Function: main_menu
FUNCTION main_menu():
    LOOP forever:
        PRINT menu options: Administrator Login, Staff Login, Member Login, Guest Access, Exit
        GET user choice
        IF choice == 1: call admin_login()
        ELIF choice == 2: call staff_login()  # staff_login currently placeholder (not implemented)
        ELIF choice == 3: call member_login()
        ELIF choice == 4: call guest_access()  # guest_access placeholder
        ELIF choice == 5: print Exiting and BREAK loop
        ELSE: print Invalid choice and continue
End Function

--- SECTION: Utilities ---
Start Function: lockout
FUNCTION lockout(locked_out_time):
    WHILE now < locked_out_time:
        remaining = seconds until locked_out_time
        PRINT "Too many incorrect attempts. Please wait {remaining} seconds." (overwrite line)
        SLEEP 1 second
    RETURN
End Function

Start Function: password_making
FUNCTION password_making(password):
    DEFINE special_characters = list of common special chars
    IF length(password) < 8: print error; return False
    IF no uppercase letter in password: print error; return False
    IF no lowercase letter in password: print error; return False
    IF no digit in password: print error; return False
    IF no special character in password: print error; return False
    RETURN True
End Function

Start Function: get_valid_password
FUNCTION get_valid_password():
    LOOP until valid:
        PROMPT Enter new password
        IF password_making(password) is False: continue
        RETURN password
End Function

Start Function: get_valid_contact
FUNCTION get_valid_contact(optional cred_files):
    default cred_files = [admin_file_C, staff_file_C, member_file_C]
    LOOP until valid:
        PROMPT Enter contact number
        exists = False
        FOR each cred_file in cred_files:
            IF file exists and not empty:
                SKIP header and iterate lines
                PARSE line into parts
                IF parts length == 3: (_, _, stored_contact) = parts
                IF input_contact == stored_contact: exists = True; break
            IF exists: break
        IF exists: print "Contact number already exists."; continue
        IF length != 10 OR not all digits: print invalid; continue
        RETURN input_contact
End Function

Start Function: get_valid_name
FUNCTION get_valid_name():
    LOOP until valid:
        PROMPT Enter name
        IF any digit in name OR name contains non-letter (excluding spaces): print invalid; continue
        RETURN name
End Function

--- ADMIN RELATED HELPERS ---
--- SECTION: Admin Functions ---
Start Function: verify_password
FUNCTION verify_password(stored_id_param, input_password):
    TRY
        IF admin_file_P exists and not empty:
            SKIP header
            FOR each line in file:
                PARSE (file_id, file_password, ...)
                IF file_id == stored_id_param AND file_password == input_password: RETURN True
        RETURN False
    EXCEPT FileNotFound: print message; RETURN False
    EXCEPT Exception: print message; RETURN False
End Function

Start Function: reverify_password
FUNCTION reverify_password(admin):
    attempts = 3
    IF admin_file_P exists and not empty:
        SKIP header
        FOR each line in file:
            PARSE (_, stored_password, stored_phrase)
            WHILE attempts > 0:
                PROMPT Re-enter password and security phrase
                IF both match stored values: RETURN True
                ELSE attempts -= 1; print attempts left
    IF attempts == 0:
        locked_out = now + 1 minute
        CALL lockout(locked_out)
        attempts = 3
        RETURN admin_menu(admin)
    ON exception: print error; RETURN False
End Function

Start Function: admin_id_generator
FUNCTION admin_id_generator():
    IF admin_file_C exists and not empty:
        SKIP header; num_users = count remaining lines
        new_admin_id = zero-pad(num_users + 1, width=5)
    ELSE: new_admin_id = "00001"
    PRINT generated id; RETURN new_admin_id
End Function

Start Function: credential_verification
FUNCTION credential_verification(input_id, input_password, sec_phrase):
    IF admin_file_P exists and not empty:
        SKIP header
        FOR each line in file:
            PARSE stored_id, stored_password, stored_phrase
            IF input_id == stored_id AND input_password == stored_password AND sec_phrase == stored_phrase:
                PRINT Credentials verified successfully; RETURN True
    PRINT Invalid Admin ID or Password; RETURN False
End Function

Start Function: admin_table
FUNCTION admin_table():
    TRY open admin_file_C
        READ header -> headers
        PARSE subsequent lines into admin_data where field count matches headers
        IF not admin_data: PRINT "No data to be displayed"
        PRINT formatted header and each admin row in a table-like layout
    EXCEPT FileNotFound: print error
    EXCEPT Exception: print error
End Function

--- STAFF HELPERS ---
--- SECTION: Staff Functions ---
Start Function: StaffID_Generator
FUNCTION StaffID_Generator():
    Same as admin_id_generator but uses staff_file_C; return zero-padded id
End Function

Start Function: staff_table
FUNCTION staff_table():
    Same table display logic as admin_table for staff_file_C
End Function

--- MEMBER HELPERS ---
--- SECTION: Member Functions ---
Start Function: member_table
FUNCTION member_table():
    Read member_file_C header and rows; print formatted member table; handle file-not-found
End Function

Start Function: member_id_generator
FUNCTION member_id_generator():
    Same approach as admin_id_generator but for member_file_C
End Function

Start Function: add_member
FUNCTION add_member():
    TRY:
        PRINT "Member Registration"
        name = get_valid_name(); password = get_valid_password(); contact = get_valid_contact(); security_phrase = PROMPT
        member_id = member_id_generator()
        IF member_file_C missing/empty: create and write header "MemberID,Name,Contact"
        APPEND (member_id, name, contact) to member_file_C
        IF member_file_P missing/empty: create and write header "MemberID,Password,Security_Question"
        APPEND (member_id, password, security_phrase) to member_file_P
        CALL view_members() and PRINT success
        PROMPT continue_choice: 'y' -> repeat add_member(); 'n' -> return manage_members()
    EXCEPT FileNotFound: print error
    EXCEPT Exception: print error
End Function

Note: In current source, `manage_members` calls `add_member(admin)` but `add_member` is defined with no parameters. This is a signature inconsistency in the source.

Start Function: remove_member
FUNCTION remove_member():
    SHOW members table, read member_file_P -> member_sec, read member_file_C -> member_cred
    PROMPT selected_member ID or 'cancel'
    IF 'cancel': return manage_members()
    FIND indices for selected_member in both lists
    IF not found: print message; continue
    ELSE confirm deletion
        IF confirmed: remove rows from both lists; write back both files with header and remaining rows
        PRINT success; PROMPT to repeat or return manage_members()
End Function

Start Function: password_reset_member
FUNCTION password_reset_member():
    SHOW members table; read member files
    PROMPT selected_member ID or 'cancel'
    IF 'cancel': return manage_members()
    FIND index in member_sec
    IF not found: print message
    ELSE confirm reset
        IF confirmed: new_password = get_valid_password(); new_security_phrase = PROMPT
            UPDATE member_sec[index] with new values; write member_file_P; PRINT success; prompt repeat or return
End Function

Start Function: view_members
FUNCTION view_members(admin):
    CALL member_table(); WAIT for Enter; return manage_members(admin)
End Function

Start Function: view_member_logs
FUNCTION view_member_logs(admin):
    Placeholder: print message and return manage_members(admin)
End Function

--- ADMIN LOGIN & MENUS ---
Start Function: admin_login
FUNCTION admin_login():
    attempts = 3
    WHILE attempts > 0:
        PROMPT Admin ID, Password, Security Phrase
        IF credential_verification(...) returns True:
            admin = (input_id, input_password, sec_phrase)
            RETURN admin_menu(admin)
        ELSE: print invalid with remaining attempts; attempts -= 1
        IF attempts == 0: locked_out = now + 1 minute; CALL lockout(locked_out); attempts = 3; RETURN main_menu()
    Handle FileNotFound and other exceptions by printing and returning to main_menu()
End Function

Start Function: admin_menu
FUNCTION admin_menu(admin):
    LOOP forever:
        PRINT admin menu options
        GET choice
        IF choice requires sensitive action: call reverify_password(admin) and on True return the corresponding manage_* function
        Map choices:
            1 -> if reverify_password(admin): return manage_admin(admin)
            2 -> if reverify_password(admin): return manage_staff(admin)
            3 -> if reverify_password(admin): return manage_members(admin)
            4 -> if reverify_password(admin): return manage_repository(admin)
            5 -> logout -> return main_menu()
        Else print invalid
End Function

--- MANAGE ADMIN ---
Start Function: manage_admin
FUNCTION manage_admin(admin):
    LOOP: present options View/Add/Remove/Reset/Previous/Logout
    Map choices to view_admin, add_admin, remove_admin, password_reset_admin, admin_menu, main_menu
End Function

Start Function: view_admin
FUNCTION view_admin(admin):
    CALL admin_table(); WAIT Enter; return manage_admin(admin)
End Function

Start Function: add_admin
FUNCTION add_admin(admin):
    PROMPT name, password, contact, security_phrase
    admin_id = admin_id_generator()
    Ensure admin files have headers; append rows to both admin_file_C and admin_file_P
    CALL admin_table(); PRINT success
    PROMPT to add another or return manage_admin
End Function

Start Function: remove_admin
FUNCTION remove_admin(admin):
    SHOW admin_table(); load admin files; PROMPT Admin ID or 'cancel'
    IF cancel -> return manage_admin
    FIND indices; IF not found print message
    ELSE confirm and on 'y' remove rows and write both files; PRINT success; prompt repeat or return
End Function

Start Function: password_reset_admin
FUNCTION password_reset_admin(admin):
    SHOW admin_table(); load admin files
    PROMPT Admin ID or 'cancel'
    IF cancel -> return manage_admin
    FIND index; IF not found print message
    ELSE confirm; new_password = get_valid_password(); new_security_phrase = PROMPT
        UPDATE admin_sec and write admin_file_P; PRINT success; prompt repeat or return
End Function

--- STAFF MANAGEMENT ---
Start Function: manage_staff
FUNCTION manage_staff(admin):
    LOOP: show staff management menu; map to view_staff, add_staff, remove_staff, password_reset_staff, admin_menu, main_menu
End Function

Start Function: view_staff
FUNCTION view_staff(admin):
    CALL staff_table(); WAIT Enter; return manage_staff(admin)
End Function

Start Function: add_staff
FUNCTION add_staff(admin):
    PROMPT name, password, contact, security_phrase
    staff_id = StaffID_Generator(); ensure files/headers; append to files; show table; prompt repeat/return
End Function

Start Function: remove_staff
FUNCTION remove_staff(admin):
    SHOW staff_table(); load staff files; PROMPT staff ID or 'cancel'
    IF cancel -> return manage_staff
    FIND indices; IF not found print message
    ELSE confirm deletion; remove rows and write files; PRINT success; prompt repeat or return
End Function

Start Function: password_reset_staff
FUNCTION password_reset_staff(admin):
    SHOW staff_table(); load staff files
    PROMPT staff ID or 'cancel'
    IF cancel -> return manage_staff
    FIND index; IF not found print message
    ELSE confirm; new_password = get_valid_password(); new_security_phrase = PROMPT
        UPDATE staff_sec and write staff_file_P; PRINT success; prompt repeat or return
End Function

--- MEMBER MANAGEMENT MENU ---
Start Function: manage_members
FUNCTION manage_members(admin):
    LOOP: show menu: View Members, View Member logs, Add Member, Remove Member, Reset Password, Previous Menu, Logout
    Map choices to view_members, view_member_logs, add_member (note: source calls add_member(admin) but function is parameterless), remove_member, password_reset_member, admin_menu, main_menu
End Function

--- REPOSITORY MANAGEMENT ---
Start Function: manage_repository
FUNCTION manage_repository(admin):
    LOOP: show repository menu: View Repository, Add to Repository, Remove from Repository, Book Logs, Previous Menu, Logout
    Map choices to view_repository, add_repository, remove_book, view_book_logs, admin_menu, main_menu
End Function

Start Function: repository_table
FUNCTION repository_table():
    TRY open repository; READ header and rows into repository_data; PRINT formatted table using computed column widths; handle empty data
    EXCEPT FileNotFound: print error
    EXCEPT Exception: print error
End Function

Start Function: isbn_checker
FUNCTION isbn_checker(isbn):
    WHILE not (isbn.isdigit() AND length(isbn) == 13): prompt again and return valid isbn
    RETURN isbn
End Function

Start Function: book_id_generator
FUNCTION book_id_generator():
    IF repository exists and not empty: skip header; num_books = count lines; new_book_id = "B" + zero-pad(num_books+1,4)
    ELSE: new_book_id = "B0001"
    PRINT generated id; RETURN new_book_id
End Function

Start Function: view_repository
FUNCTION view_repository(admin):
    CALL repository_table(); WAIT Enter; RETURN manage_repository(admin)
End Function

Start Function: add_repository
FUNCTION add_repository(admin):
    LOOP:
        PRINT "Add to Repository" and guidance for 'cancel'
        bookID = book_id_generator()
        isbn = isbn_checker(PROMPT)
        name = PROMPT Book Name
        category = PROMPT Book Category
        Availability = 'Available'
        new_book = (bookID, isbn, name, category, Availability)
        IF repository missing/empty: create with header "BookID,ISBN,Name,Category,Availability"
        APPEND new_book to repository
        PRINT success; PROMPT continue_choice: 'y' repeat, 'n' return manage_repository(admin)
    EXCEPT Exception: print error and return manage_repository(admin)
End Function

Start Function: remove_book
FUNCTION remove_book(admin):
    SHOW repository_table(); load repository into book_data
    PROMPT Book ID to remove or 'cancel'
    IF 'cancel' -> return manage_repository()
    FIND book_index; IF not found print message
    ELSE confirm deletion; if confirmed pop row and write back file (header + rows); PRINT success; prompt repeat or return
End Function

Start Function: view_book_logs
FUNCTION view_book_logs(admin):
    TRY read BookLog; parse header and rows; compute column widths; PRINT formatted table; WAIT Enter; RETURN manage_repository(admin)
    EXCEPT FileNotFound or Exception: print error
End Function

--- MEMBER LOGIN & MENU ---
Start Function: member_credential_verification
FUNCTION member_credential_verification(input_id, input_password, sec_phrase):
    IF member_file_P exists and not empty:
        SKIP header; FOR each line: parse stored_id, stored_password, stored_phrase
            IF all inputs match stored values: PRINT success; RETURN True
    PRINT Invalid Member ID or Password; RETURN False
End Function

Start Function: member_login
FUNCTION member_login():
    attempts = 3
    WHILE attempts > 0:
        PROMPT Member ID, Password, Security Phrase
        IF member_credential_verification(...) returns True:
            member = (input_id, input_password, sec_phrase)
            PRINT member
            RETURN member_menu(member)
        ELSE: print invalid and remaining attempts; attempts -= 1
        IF attempts == 0: locked_out = now + 1 minute; CALL lockout(locked_out); attempts = 3; RETURN main_menu()
    Handle FileNotFound and other exceptions by printing and returning main_menu()
End Function

Start Function: member_menu
FUNCTION member_menu(member):
    LOOP:
        PRINT "Member Menu": Borrow a Book, View Book History, Logout
        GET choice
        IF choice == 1: CALL borrow_book(member)

        ELIF choice == 2:
            # View Book History for this member
            OPEN BookLog file and read all lines
            FILTER lines to only those where first field == member[0]
            REDUCE to first instance per BookID (keep unique BookID entries in order)
            FOR each remaining line: PRINT formatted log entry (skip MemberID field)

        ELIF choice == 3: PRINT Logging out; RETURN main_menu()
        ELSE: PRINT Invalid choice
End Function

Start Function: borrow_book
FUNCTION borrow_book(member):
    TRY:
        LOOP:
            CALL repository_table()
            READ repository header and book_data
            PROMPT Book ID to borrow or 'cancel'
            IF 'cancel' -> PRINT canceled; RETURN member_menu(member)
            FIND book_index by BookID
            IF not found: PRINT no matching Book ID
            ELSE:
                selected = book_data[book_index]
                PROMPT confirm (y/n)
                IF confirm != 'y': PRINT canceled; RETURN member_menu(member)
                borrow_date = now as YYYY-MM-DD
                book_data[book_index][4] = 'Borrowed'
                APPEND borrow_date to that row
                WRITE header + all book_data rows back to repository
                PRINT success; PROMPT continue_choice: 'y' -> repeat borrow_book(member), 'n' -> return member_menu(member)
    EXCEPT Exception: print error; RETURN member_menu(member)
End Function

Start Function: member_reverify_password
FUNCTION member_reverify_password(member):
    attempts = 3
    IF member_file_P exists and not empty:
        SKIP header; FOR each line parse _, stored_password, Sec_Phrase
            WHILE attempts > 0:
                PROMPT re-enter password and phrase
                IF both match: RETURN True
                ELSE decrement and warn
    IF attempts == 0: locked_out = now + 1 minute; CALL lockout(locked_out); attempts = 3; RETURN member_menu(member)
    ON exception: print error; RETURN False
End Function

--- GUEST ACCESS ---
Start Function: guest_access
# guest_access currently present as placeholder; not implemented
End Function

--- PROGRAM ENTRY POINT ---
Start Program
Start Function: main
FUNCTION main():
    LOOP: call main_menu()
End Function

IF this file executed as script: call main()
End Program

--- NOTES & OBSERVATIONS ---
- The pseudocode now reflects functions that were implemented or expanded in the source: member history viewing, borrow flow, repository add/remove, book logs, and repository table formatting.
- There are a few signature/call inconsistencies in the source code (for example, `manage_members` calls `add_member(admin)` but `add_member` is defined without parameters). The pseudocode notes this mismatch.
- Error handling follows the source: try/except blocks return to appropriate menus on failures.
- Many functions follow the same pattern: show table, prompt for ID/cancel, find index, confirm, mutate in-memory list, write file, loop or return to menu.

-End of pseudocode.
